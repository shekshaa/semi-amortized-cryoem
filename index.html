<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap CSS -->
        <title>Cryo-SAPIENCE</title>
        <!-- <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet"> -->

        <link rel="stylesheet" href="static/css/bulma.min.css">
        <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
        <link rel="stylesheet" href="static/css/bulma-slider.min.css">
        <!-- <link rel="stylesheet" href="static/css/fontawesome.all.min.css"> -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
        <link rel="stylesheet" href="static/css/index.css">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" 
                               integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

        <script defer src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script defer src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
        <!-- <script defer src="static/js/fontawesome.all.min.js"></script> -->
        <script defer src="static/js/bulma-carousel.min.js"></script>
        <script defer src="static/js/bulma-slider.min.js"></script>
        <script defer src="static/js/index.js"></script>
        <script defer src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default'></script>
    </head>
    <body class="container" style="max-width:1000px">
        <!-- Title -->
        <div>
            <div class='row mt-4 mb-2'>
                <div class='col text-center'>
                    <!-- <p class="h3 font-weight-bold">Improving Ab-Initio Cryo-EM Reconstruction with Semi-Amortized Pose Inference</p> -->
                    <p class="h2 font-weight-bold">Cryo-SAPIENCE</p>
                    <p class="h5">Improving Ab-Initio <span style="font-weight: bold; font-size: 1.2em;">Cryo</span>-EM Reconstruction with <span style="font-weight: bold; font-size: 1.2em;">S</span>emi-<span style="font-weight: bold; font-size: 1.2em;">A</span>mortized <span style="font-weight: bold; font-size: 1.2em;">P</span>ose <span style="font-weight: bold; font-size: 1.2em;">I</span>nfer<span style="font-weight: bold; font-size: 1.2em;">ence</span></p>
                </div>
            </div>
            <div class='row mt-2 mb-4'>
              <div class='col text-center'>
                  <p class="h5">NeurIPS 2024</p>
              </div>
          </div>             
            <!-- authors -->
            <div class='col text-center h5 font-weight mb-3'>
            <a href="https://shekshaa.github.io/">Shayan Shekarforoush</a><sup>1,2</sup>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="https://davidlindell.com/">David Lindell</a><sup>1,2</sup>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="https://mbrubake.github.io/">Marcus Brubaker</a><sup>1,2,3,4</sup>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="http://www.cs.toronto.edu/~fleet/">David Fleet</a><sup>1,2,3</sup>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
            </div>

            <!-- affiliations -->
            <div class='col text-center mt-4 mb-4' >
            <sup>1</sup>University of Toronto &nbsp;&nbsp;&nbsp; 
            <sup>2</sup>Vector Institute &nbsp;&nbsp;&nbsp;
            <sup>3</sup>Google Research &nbsp;&nbsp;&nbsp;
            <sup>4</sup>York University
            </div>
            <div class="col text-center mt-4 mb-4">
              <div class="publication-links">
                <!-- PDF link -->
                <span class="link-block">
                  <a href="https://arxiv.org/pdf/2406.10455" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2406.10455" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <!-- Github link -->
                <span class="link-block">
                  <a href="https://github.com/shekshaa/semi-amortized-cryoem" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

              </div>
            </div>

            <section class="hero teaser">
              <div class="container is-max-desktop">
                  <img src="assets/teaser.png" alt="MAIN_FIGURE" />
                  <p class="h7">
                    Semi-amortization consists of two stages: (i) an auto-encoding stage 
                    where an image encoder with multiple heads maps the input image to the pose candidate set, 
                    followed by computing projections by slicing through the volume decoder in Fourier space.
                    The projections are compared with the input image and the one with the minimum error is used. 
                    (ii) An auto-decoding stage where pose parameters are stored in a look-up table for all images and directly optimized using stochastic gradient descent (SGD).
                  </p>
              </div>
            </section>
              
      </div>

      <div>
        <hr>
        <div class="row">
            <div class="col-md-3 col-sm-3 col-xs-12 text-center">
                <div class="row mt-4">
                    <a href="https://arxiv.org/abs/2206.00746" style="max-width:200px; margin-left:auto; margin-right:auto">
                        <img src="assets/snapshot.png" alt="paper-snapshot" class="img-thumbnail" width="80%" style="box-shadow: 10px 10px 5px grey;">
                    </a>
                </div>
            </div>
            <div class="col-md-9 col-sm-9 col-xs-12">
                <p class="h4 font-weight-bold ">Abstract</p>
                <p style="line-height:1.4;">
                  Cryo-EM is an increasingly popular method for determining the atomic resolution 3D structure of macromolecular complexes (eg, proteins) from noisy 2D images captured by an electron microscope.
                  The computational task is to reconstruct the 3D density of the particle, along with 3D pose of the particle in each 2D image, for which the posterior pose distribution is highly multi-modal. 
                  Recent developments in cryo-EM have focused on deep learning for which amortized inference has been used to predict pose.  
                  Here, we address key problems with this approach, and propose a new semi-amortized method in which reconstruction begins with amortized inference and then switches to a form of auto-decoding to refine poses locally using stochastic gradient descent.  
                  Through evaluation on synthetic datasets, we demonstrate that our method is able to handle multi-modal pose distributions during the amortized inference stage, while the later, more flexible stage of direct pose optimization yields faster and more accurate convergence of poses compared to baselines. 
                  On experimental data, we show that our approach outperforms the state-of-the-art cryoAI in  speed and reconstruction quality. 
                </p>
            </div>
        </div>
    </div>
    <hr>
    <section class="hero is-small">
        <div class="container is-max-desktop">
          <h2 class="title has-text-centered">Reconstruction Results</h2>
          <div id="results-carousel" class="carousel results-carousel">
            <div class="item item-video2">
              <video poster="" id="video2" autoplay controls muted loop height="80%" loading="lazy">
                <source src="./assets/hsp_movie.m4v" type="video/mp4">
              </video>
            </div>
            <div class="item item-video3">
              <video poster="" id="video3" autoplay controls muted loop height="80%" loading="lazy">\
                <source src="./assets/spliceosome_movie.m4v" type="video/mp4">
              </video>
            </div>
            <div class="item item-video1">
              <video poster="" id="video1" autoplay controls muted loop height="80%" loading="lazy">
                <source src="./assets/spike_movie.m4v" type="video/mp4">
              </video>
            </div>
            <div class="item item-video4">
              <video poster="" id="video4" autoplay controls muted loop height="80%" loading="lazy">\
                <source src="./assets/empiar10028_movie.m4v" type="video/mp4">
              </video>
            </div>
          </div>
        </div>
    </section>
    <hr>
    <section class="hero is-small">
      <div class="container is-max-desktop">
        <h2 class="title has-text-centered">Semi-Amortized vs. Fully-Amortized</h2>
        <p> 
          We branch the running reconstruction into two after a certain number of epochs: 
          the first continues using the encoder <span style="color: red;">(Fully-Amortized)</span> 
          while the second switches to direct pose optimization <span style="color: blue;">(Semi-Amortized)</span>. 
          We mark the trajectory of pose estimates for example images over a heat map showing the approximate (log) pose posterior (marginalized over in-plane rotations) as a view-direction distribution on a uniform grid of the unit sphere \( S^2 \). 
          After Gnomonic projection to 2D, we show the neighborhood around optimization trajectories.  
          Each cell shows an area of 10 degrees and the error of final estimates are also provided for each example.
        </p>
        <div id="results-carousel" class="carousel results-carousel">
          <div class="item item-video2">
            <video poster="" id="pose-video1" autoplay controls muted loop height="80%" loading="lazy">
              <source src="./assets/poses/spliceosome.m4v" type="video/mp4">
            </video>
          </div>
          <div class="item item-video3">
            <video poster="" id="pose-video2" autoplay controls muted loop height="80%" loading="lazy">\
              <source src="./assets/poses/spike.m4v" type="video/mp4">
            </video>
          </div>
        </div>
      </div>
  </section>

    <!-- Ack -->
    <div>
        <hr>
        <div class='row mb-5 text-center'>
            <div class='col'>
                <!-- <p class='h2'>Acknowledgements</p> -->
                <div class='text-left'>
                    <p>The design of this project page is based on <a href="https://www.guandaoyang.com/PointFlow/">this</a> website.
                </div>
            </div>
        </div>
    </div>
  </body>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const videos = document.querySelectorAll("video source");
      videos.forEach(function(video) {
        // Check if cache-busting parameter is needed
        if (!localStorage.getItem(video.src)) {
          localStorage.setItem(video.src, '1'); // Versioning or flagging
        } else {
          // Append cache-busting query string
          video.src = video.src + '?v=' + localStorage.getItem(video.src);
        }
      });
    });
  </script>  
</html>